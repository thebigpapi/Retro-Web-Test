import{addEvent as e,addClass as t,removeClass as r,each as l}from"../utils/helpers.js";function getNextFocusElement(e=-1){let t=document.querySelectorAll(".gbtn[data-taborder]:not(.disabled)");if(!t.length)return!1;if(1==t.length)return t[0];"string"==typeof e&&(e=parseInt(e));let r=[];l(t,e=>{r.push(e.getAttribute("data-taborder"))});let o=Math.max.apply(Math,r.map(e=>parseInt(e))),n=e<0?1:e+1;n>o&&(n="1");let a=r.filter(e=>e>=parseInt(n)),u=a.sort()[0];return document.querySelector(`.gbtn[data-taborder="${u}"]`)}export default function o(l){if(l.events.hasOwnProperty("keyboard"))return!1;l.events.keyboard=e("keydown",{onElement:window,withCallback(e,o){e=e||window.event;let n=e.keyCode;if(9==n){let a=document.querySelector(".gbtn.focused");if(!a){let u=!!document.activeElement&&!!document.activeElement.nodeName&&document.activeElement.nodeName.toLocaleLowerCase();if("input"==u||"textarea"==u||"button"==u)return}e.preventDefault();let d=document.querySelectorAll(".gbtn[data-taborder]");if(!d||d.length<=0)return;if(!a){let i=getNextFocusElement();i&&(i.focus(),t(i,"focused"));return}let s=getNextFocusElement(a.getAttribute("data-taborder"));r(a,"focused"),s&&(s.focus(),t(s,"focused"))}39==n&&l.nextSlide(),37==n&&l.prevSlide(),27==n&&(window.history.go(-1),l.close())}})};